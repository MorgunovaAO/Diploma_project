# 2.4 Техники тест-дизайна 

Прежде, чем приступить к работе, тестировщик изучает полученные требования на новую фичу **(тест-анализ)**, затем переходит к написанию тестовой документации **(тест-дизайну)** и только потом, когда разработчик реализует фичу, тестировщик начинает **тестировать**. 

**Тест-дизайн** — это этап тестирования ПО, на котором проектируются и создаются тестовые случаи (тест-кейсы) в соответствии с определенными ранее критериями качества и целями тестирования. 

Условно: требования = критерии качества. 

## Цели тест-дизайна:  

1. максимально покрыть функциональность тестами;  

2. обнаружить самые серьезные баги;  

3. сократить количество тестов за счет исключения непродуктивных тест-кейсов;  

4. не пропустить важные тесты. 

Тест-дизайн позволяет провести тестирование наиболее эффективно, чтобы завершить его в установленные сроки. При этом система должна быть покрыта так, чтобы не оставалось функциональностей, не покрытых проверками. 

Мы помним, что Исчерпывающее тестирование недостижимо. Вместе с тем благодаря техникам тест-дизайна становится возможным сократить количество тестов без потери качества тестирования. 

## Техники тест-дизайна 

* классы эквивалентности (эквивалентное разделение);  

* граничные значения (анализ граничных значений, метод граничных значений);  

* попарное тестирование (тестовая комбинаторика);  

* тестирование состояний и переходов;  

* таблицы принятия решений;  

* исследовательское тестирование. 

## Классы эквивалентности 

**Класс эквивалентности** — это входные (а иногда и выходные) данные, которые обрабатываются одинаковым образом и приводят к одному результату. 

**Тестирование на основе классов эквивалентности** (equivalence partitioning) — техника тест-дизайна на основе метода черного ящика, в ходе выполнения которой все данные делятся на классы эквивалентности, а затем тестирование проводится на одном значении из этого класса. 

### Главный принцип техники на основе классов эквивалентности: 

Нет необходимости проверять каждое значение из класса эквивалентности отдельно:

* если один тест выявит ошибку — остальные, скорее всего, тоже это сделают; 

* если один из тестов не выявит ошибку — остальные, скорее всего, тоже этого не сделают.

Что можно разбить на классы эквивалентности:

1. числа; 
2. символы; 
3. длину строки; 
4. размер файла; 
5. объем памяти; 
6. разрешение экрана; 
7. версии операционных систем, библиотек;
8. объем передаваемых данных и др.

**Линейные (упорядоченные)** классы эквивалентности - значения можно расположить на шкале, всегда есть границы. Граница может входить в класс, а может быть самостоятельной единицей.

**Нелинейные (неупорядоченные)** классы эквивалентности - значения нельзя упорядочить, граничных значений нет.

### Алгоритм работы с классами эквивалентности: 

1. На основе анализа нужно выбрать параметры, которые влияют на результат;

2. Для каждого параметра выделить класс эквивалентности;

3. Из каждого класса выбрать одно значение;

4. При необходимости, обработать выбранное значение в соответствии с техникой попарного тестирования (будет рассмотрена далее).

## Граничные значения 

**Техника анализа граничных значений** — проверка поведения продукта на крайних (граничных) значениях входных данных. Граничные значения обязательно следует применять при написании тестов, так как именно в этом месте чаще всего и обнаруживаются ошибки. Применима только к линейным классам эквивалентности.

### Алгоритм техники анализа граничных значений 

1. Выделить классы эквивалентности.  

2. Определить граничные значения этих классов.  

3. Определить, к какому классу будет относиться каждая граница. 

4. Для каждой границы провести тесты по проверке значения до границы, на ней и сразу после нее. 

## Попарное тестирование 

**Попарное тестирование** (pairwise testing) — техника формирования наборов тестовых данных, при которой каждое тестируемое значение каждого из проверяемых параметров хотя бы раз сочетается с каждым из тестируемых значений всех остальных проверяемых параметров. Используется только для нелинейных классов эквивалентности. 

### Главный принцип техники попарного тестирования:

Большинство дефектов возникает при комбинации двух параметров, поэтому нет смысла проверять все возможные сочетания всех параметров. Если мы попытаемся проверить все сочетания всех значений всех параметров для сложного случая тестирования, мы получим количество тест-кейсов, превышающее все разумные пределы. 

### Особенности техники Pairwise:  

* хорошо масштабируется при увеличении параметров (классов эквивалентности)

* плохо масштабируется при увеличении количества значений

* при составлении тестовых наборов пар **никогда** не учитываются негативные сценарии. Невалидные значения не комбинируются друг с другом, иначе тестировщик не сможет установить причину возможной ошибки. Т.е. в первую очередь составляем пары из валидных значений.

* проверки с невалидными значениями добавляются в конце таблицы по принципу: "Один невалидный параметр в строке. Остальные параметры могут быть любыми валидными".

* при составлении попарных комбинаций лучше начинать с параметра, у которого больше всего вариантов значений. Далее нужно рассмотреть классы по уменьшению количества значений.

* при ручном построении попарных комбинаций:

    * Столбцы - это нелинейные классы эквивалентности. 

    * Строки - параметры для каждого класса (заполняются в столбик под названием соответствующего класса).
    
    * Сначала записываем все возможные комбинации первого и второго столбца. Затем третий столбец сравниваем поочередно с первым и вторым, определяя все возможные комбинации. Добавляем четвертый - также поочередно сравниваем пары из 1,2,3 столбца с 4. И так далее. При этом проверяем, что учтены все возможные комбинации, при необходимости - меняем местами значения внутри класса.

### Программы для автоматического составления Pairwise:

* Pairwise Online Tool 
* PICT 
* Allpairs
* VPTag 

## Тестирование на основе диаграмм и таблиц переходов состояний 

**Тестирование на основе диаграмм и таблиц переходов состояний** (State-Transition Testing) — это техника тест-дизайна для систем, которые изменяют свое состояние в зависимости от внешних стимулов. Используется для наглядного представления сценариев и выявления негативных кейсов. В ходе применения данной техники описываются конкретные состояния приложения и то, как они могут меняться. 

### Элементы диаграммы переходов состояний:

**Точка входа** — черная точка на диаграмме. 

**Переход** (transition) (стрелка) — представляет переход из одного состояния в другое, происходящий по событию. 

**Состояние** (state) (круг) — состояние приложения, в котором оно ожидает одного или нескольких событий. 

**Событие** (event) (надпись над стрелкой) — то, что сделал пользователь. 

**Действие** (action) (над стрелкой, после события) — реакция приложения на событие.

**Точка выхода** — показана на диаграмме как мишень. 

**Условия перехода** (transition conditions) — условия, в соответствии с которыми система будет выполнять то или иное действие. 

При составлении тестов по диаграмме переходов состояний следует применять такой уровень покрытия, где каждый переход используется хотя бы в одном тесте. Уровень тестового
покрытия при этом оптимален, так как затронет все состояния, действия и события. Он может совпадать с покрытием всех возможных путей.

Недостаток диаграмм - отсутствие негативных сценариев. Если попытаемся их изобразить на диаграмме, то появится большое количество стрелок и диаграмма станет нечитаемой. Для негативных тестов удобнее использовать *таблицу переходов состояний*, которая также помогает лучше систематизировать сведения о системе.

### Таблицы переходов состояний состоят из 4 колонок:

1. Текущее состояние
2. Событие 
3. Действие
4. Новое состояние

### Алгоритм составления таблицы переходов состояний: 

1. Сопоставить состояния и события по принципу «все ко всем» и заполнить столбцы «Текущее состояние», «Событие».
2. Там, где смена состояний вызывает действие, описать его в столбце «Действия».
3. В каждой строке указать новое состояние. Если событие не ведёт к смене состояния, то новое состояние совпадает с текущим.

### Алгоритм составления тестов по таблице:

1. Выделить зелёным все возможные переходы.
2. Выявить невозможные переходы, которые несут риски, и выделить их
красным. Это будут негативные проверки. Для выявления рисков
тестировщики советуются с разработчиками или аналитиками.

### Плюсы диаграмм состояний и переходов:

* позволяют визуализировать состояния продукта;

* демонстрируют варианты переходов, которые можно пропустить; 

* помогают отследить дефект, сужая его локацию до конкретного перехода; 

* показывают внутреннюю механику продукта. 

### Минусы диаграмм состояний и переходов:

* можно пропустить неочевидные переходы; 

* при слишком сложной структуре продукта диаграммы могут стать громоздкими и запутанными; 

* являются только основой к применению других методов; 

* бесполезны при плохом знании продукта.

Диаграммы переходов состояний не применимы, если система не изменяет состояние и не должна реагировать на внешние стимулы определённым образом.

## Таблицы принятия решений 

**Таблицы принятия решений** (decision table) — техника тестирования черного ящика, применяется для систем со сложной логикой. Помогает быстрее разобраться в бизнес-логике приложения, упорядочить ее, а также протестировать все возможные комбинации условий. 

### Сущности, из которых состоят таблицы 

**Условия** (conditions) — короткое описание входных условий (данных), сформулированное в виде вопроса. 

**Действия** (actions) — четкое описание ожидаемого результата, действия системы. 

**Значения** (values) — значения, допустимые для входных данных, указанных в условии. 

**Правила** (rules) — комбинации входных данных, которые отражены в таблице. 

### Цель применения:  

* упорядочить и задокументировать сложную логику приложения; 

* протестировать все комбинации условий и состояний. 

### Пример. Рассылка писем 

Требование: для поддержания системы лояльности провести информационную рассылку постоянным клиентам. Содержание писем зависит от следующих условий: 

* Клиенты типа А, В получают стандартное письмо. 

* Клиенты типа С получают специальное письмо. 

* Клиентам, совершившим пять и более покупок или купившим на сумму более 500 долларов, в письме сообщается о дополнительной скидке 20% на следующий заказ. 

План действий:

1. Разбить требование на условия. 

2. Посчитать количество возможных правил (комбинаций).

3. Составить таблицу принятия решений. 

4. Исключить лишние комбинации, если они есть. 

5. Создать тесты. 

Количество возможных комбинаций:

X = Y1*Y2*...*Yn, где Х — вычисляемое количество комбинаций; 

Y1...Yn — количество вариантов каждого условия; 

N — количество условий. 

Y1 = 4 (четыре значения для условия «Тип клиента» — «A, B, C, D»); 

Y2 = 2 и Y3 = 2 (по два значения для условий «Пять и более покупок» и «Сумма больше 500 долларов» — «YES/NO»); 

N = 3 (требование содержит три условия); 

X = 4 * 2 * 2; 

Х = 16 правил (комбинаций условий). 

### Плюсы таблиц принятия решений:

* помогают быстро составлять тестовые сценарии; 

* позволяют выявить неполноту требований;

* их можно использовать при отсутствии требований;

* можно быстро проверить покрытие требований тест-кейсами;

* позволяют предугадывать возможные ошибки. 

### Минусы таблиц принятия решений:

* при большом количестве условий таблицы могут быть громоздкими; 

* их сложно составлять и использовать; 

* сложность в корректном определении условий, действий и значений при первоначальном проектировании. 

## Исследовательское тестирование 

**Исследовательское тестирование** (exploratory testing) — неформальный метод проектирования тестов, при котором тестировщик активно контролирует проектирование тестов во время выполнения. Полученную при тестировании информацию использует для проектирования новых и улучшенных тестов. 

Исследовательское тестирование (exploratory testing) — также одновременное изучение программного продукта, проектирование тестов и их исполнение. 

### Преимущества применения исследовательского тестирования: 

* быстрая обратная связь о качестве новой функциональности;

* быстрое изучение тестируемого продукта; 

* контроль работы других тестировщиков; 

* недостаток времени для составления тестовых сценариев; 

* отсутствие требований; 

* небольшой проект, для которого не требуется структурированный подход к тестированию; 

* внезапные изменения в проекте; 

* дополнительные проверки. 

### Плюсы исследовательского тестирования:  

* не нужно тратить время на предварительное описание всех сценариев; 

* не нужна поддержка тестовых сценариев; 

* не происходит привыкание к тестовым сценариям, и их прохождение не происходит «не глядя»; 

* не теряется цельное видение продукта; 

* критические дефекты находятся быстрее; 

* повышается скорость тестирования; 

* можно сразу начинать тестировать продукт, даже если требований нет вообще; 

* исследовательское тестирование интереснее и креативнее (тесты ограничиваются только фантазией и глубиной знаний о продукте). 

### Минусы исследовательского тестирования:  

* сложно планировать время на проведение тестирования без задокументированных заранее сценариев;

* вероятность пропустить ключевые проверки, так как отсутствует ранжирование сценариев по степени важности;

* сложность оценки полноты покрытия требований тестами;

* требуется высокая квалификация тестировщиков и хорошее знание тестируемого приложения;

* сложно использовать для регрессионного тестирования;

* невозможно автоматизировать такое тестирование. 
 
## Краткое подведение итогов:

**Тест-дизайн**— это этап тестирования ПО, на котором проектируются и создаются тестовые случаи (тест-кейсы) в соответствии с определенными ранее критериями качества и целями тестирования. 
 
1. Тестирование на основе классов эквивалентности (equivalence partitioning) — это техника, основанная на методе чёрного ящика, при которой мы разделяем функционал (часто диапазон возможных вводимых значений) на группы эквивалентных по своему влиянию на систему значений. 

2. Техника анализа граничных значений (boundary value testing) — это техника проверки поведения продукта на крайних (граничных) значениях входных данных. 

3. Доменный анализ (Domain Analysis Testing) — это техника основана на разбиении диапазона возможных значений переменной на поддиапазоны, с последующим выбором одного или нескольких значений из каждого домена для тестирования. 

4. Попарное тестирование (pairwise testing) — это техника формирования наборов тестовых данных из полного набора входных данных в системе, которая позволяет существенно сократить количество тест-кейсов. 

5. Тестирование на основе состояний и переходов (State-Transition Testing) — это техника тест-дизайна для систем, которые изменяют свое состояние в зависимости от внешних стимулов.

6. Таблицы принятия решений (Decision Table Testing) — техника тестирования, основанная на методе чёрного ящика, которая применяется для систем со сложной логикой.  

7. Исследовательское тестирование (exploratory testing) — также одновременное изучение программного продукта, проектирование тестов и их исполнение. 

Источники:

https://habr.com/ru/post/549054/